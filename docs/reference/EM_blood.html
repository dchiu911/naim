<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>EM algorithm for estimating frequency of A, B, and O blood alleles — EM_blood • naim</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">naim</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dchiu911/naim">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>EM algorithm for estimating frequency of A, B, and O blood alleles</h1>
    </div>

    
    <p>Given the phenotypic frequencies for the four blood types (A, B, AB, O), uses the EM algorithm to obtain maximum likelihood estimates for the frequency of the three blood alleles (A, B, O) in a population.</p>
    

    <pre><span class='fu'>EM_blood</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='no'>AB</span>, <span class='no'>O</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-06</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <dl class="dl-horizontal">
      <dt>A</dt>
      <dd>number of people with blood type A</dd>
      <dt>B</dt>
      <dd>number of people with blood type B</dd>
      <dt>AB</dt>
      <dd>number of people with blood type AB</dd>
      <dt>O</dt>
      <dd>number of people with blood type O</dd>
      <dt>tol</dt>
      <dd>tolerance level governing when to stop the iterations. Here we use the large absolute error for any parameter and compare it to <code>tol</code>. Iterations stop when the error is less than <code>tol</code>. Defaults to <code>1e-6</code>.</dd>
      <dt>verbose</dt>
      <dd>Logical; if <code>TRUE</code> then function prints iterative feedback to the console, and if <code>FALSE</code> there is no printing. Defaults to <code>FALSE</code>.</dd>
    </dl>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with three entries in one row, giving the estimated blood allele frequencies of A, B, and O respectively.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The genotypic frequencies are usually not known for an entire population, because people with blood type A can have a genotype of A/A or A/O, and people with blood type B can have a genotype of B/B or B/O. For blood types AB and O, there is a one-to-one mapping to the genotypes A/B and O/O however. Hence, in the EM setting, the six possible genotypes are viewed as latent variables that follow a multinomial distribution. Using traditional MLE, closed form solutions cannot be obtained.</p>
    <p>We assume that the population is in Hardy-Weinberg Equilibrium. That is, for genotype of form X/X, P(X/X) = P(X)^2 and for genotype of form X/Y, P(X/Y) = 2 * P(X) * P(Y).</p>
    <p>An initial probability estimate of (1/3, 1/3, 1/3) is reasonable as it corresponds to the situation of uniform allele frequencies. In the function definition, the iterations are updated in the calls to <code>pA_new</code>, <code>pB_new</code>, and <code>pO_new</code>. These equations are derived by going through the Expectation-Maximization algorithm and applying Lagrange multipliers as the last step.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Population of 100, with equal phenotypic frequencies</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>; <span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>; <span class='no'>AB</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>; <span class='no'>O</span> <span class='kw'>&lt;-</span> <span class='fl'>25</span>
<span class='fu'>EM_blood</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='no'>AB</span>, <span class='no'>O</span>)</div><div class='output co'>#&gt;     pA_hat   pB_hat   pO_hat
#&gt; 1 0.280212 0.280212 0.439576</div><div class='input'>
<span class='co'># Population of 1000, with different phenotypic frequencies</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fl'>500</span>; <span class='no'>B</span> <span class='kw'>&lt;-</span> <span class='fl'>200</span>; <span class='no'>AB</span> <span class='kw'>&lt;-</span> <span class='fl'>50</span>; <span class='no'>O</span> <span class='kw'>&lt;-</span> <span class='fl'>250</span>
<span class='fu'>EM_blood</span>(<span class='no'>A</span>, <span class='no'>B</span>, <span class='no'>AB</span>, <span class='no'>O</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] &quot;Initial Probs: pA = 0.333333 pB = 0.333333 pO =  0.333333&quot;
#&gt; [1] &quot;Iteration 1 : pA = 0.358333 pB = 0.158333 pO = 0.483333&quot;
#&gt; [1] &quot;Iteration 2 : pA = 0.34261 pB = 0.139074 pO = 0.518316&quot;
#&gt; [1] &quot;Iteration 3 : pA = 0.337101 pB = 0.136829 pO = 0.52607&quot;
#&gt; [1] &quot;Iteration 4 : pA = 0.335663 pB = 0.136508 pO = 0.527829&quot;
#&gt; [1] &quot;Iteration 5 : pA = 0.335314 pB = 0.13645 pO = 0.528236&quot;
#&gt; [1] &quot;Iteration 6 : pA = 0.335231 pB = 0.136438 pO = 0.528331&quot;
#&gt; [1] &quot;Iteration 7 : pA = 0.335211 pB = 0.136436 pO = 0.528353&quot;
#&gt; [1] &quot;Iteration 8 : pA = 0.335207 pB = 0.136435 pO = 0.528358&quot;
#&gt; [1] &quot;Iteration 9 : pA = 0.335206 pB = 0.136435 pO = 0.528359&quot;
#&gt; [1] &quot;Iteration 10 : pA = 0.335205 pB = 0.136435 pO = 0.52836&quot;
#&gt; [1] &quot;MLE are pA = 0.335205 pB = 0.136435 pO = 0.52836&quot;</div><div class='output co'>#&gt;     pA_hat   pB_hat  pO_hat
#&gt; 1 0.335205 0.136435 0.52836</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Derek Chiu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
