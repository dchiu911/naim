<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of naim • naim</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">naim</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dchiu911/naim">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Overview of naim</h1>
                        <h4 class="author">Derek Chiu</h4>
            
            <h4 class="date">2017-01-23</h4>
          </div>

    
    
<div class="contents">
<div id="motivation" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#motivation" class="anchor"> </a></body></html>Motivation</h2>
<p>The usual method of finding maximum likelihood estimates involves deriving the log likelihood function with respect to each parameter we want to estimate, then setting this equation to 0. But there are times when this is not possible. For example, in the logistic regression scenario, closed form solutions cannot be obtained. Thus we need to resort to some iterative method in order to compute these estimates. In this way, we usually say the MLE is found when the improvement after each iteration becomes negligible.</p>
<p>This package currently implements the Newton-Raphson method for simple logistic regression, and the EM algorithm for estimating the frequency of blood alleles.</p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#usage" class="anchor"> </a></body></html>Usage</h2>
<p>First load the package via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(naim)</code></pre></div>
<div id="nr_logitx-y-n-tol-1e-6-verbose-false" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#nr_logitx-y-n-tol-1e-6-verbose-false" class="anchor"> </a></body></html>NR_logit(x, y, n, tol = 1e-6, verbose = FALSE)</h3>
<p>The <code>NR_logit</code> function finds estimated parameters under simple logistic regression, where closed form solutions are not obtainable. Using the Newton-Raphson method, we supply an initial feasible estimate, and iteratively improve the estimate.</p>
<p>There are <strong>3 required arguments</strong>: covariates, number of trials, and successes. More details are in the documentation via <code><a href="../reference/NR_logit.html">?NR_logit</a></code>. Let’s see an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">547</span>)

<span class="co"># Covariates</span>
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">3</span>, <span class="dt">sd =</span> <span class="fl">0.2</span>)

<span class="co"># Number of trials</span>
n &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)

<span class="co"># Successes</span>
y &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">100</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="fl">0.6</span>)

<span class="co"># Data set</span>
<span class="kw">head</span>(<span class="kw">data.frame</span>(x, n, y))</code></pre></div>
<pre><code>##          x  n  y
## 1 3.067176 61 41
## 2 3.088659 23 18
## 3 2.958531 61 38
## 4 2.952617 83 50
## 5 3.324626 49 24
## 6 3.019444 90 49</code></pre>
<p>The default call to <code>NR_logit</code> returns a data.frame with the intercept and slope MLE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/NR_logit.html">NR_logit</a></span>(x, y, n)</code></pre></div>
<pre><code>##   intercept       slope
## 1 0.5229187 -0.03921141</code></pre>
<p>Suppose we wanted to see the iterative process, i.e. the incremental improvements in the estimated parameters. This can be accomplished by setting the argument <code>verbose = TRUE</code> (which is <code>FALSE</code> by default).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/NR_logit.html">NR_logit</a></span>(x, y, n, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] "Initial Value: intercept = 0 slope = 0"
## [1] "Iteration 1 : intercept = 0.5127 , slope = -0.037627"
## [1] "Iteration 2 : intercept = 0.52291 , slope = -0.039209"
## [1] "Iteration 3 : intercept = 0.522919 , slope = -0.039211"
## [1] "Iteration 4 : intercept = 0.522919 , slope = -0.039211"
## [1] "MLE are intercept = 0.522919 and slope = -0.039211"</code></pre>
<pre><code>##   intercept       slope
## 1 0.5229187 -0.03921141</code></pre>
<p>It shows the initial value used (which is always (0, 0)), the updated estimates at each iteration, and the final MLE.</p>
<p>The stopping criterion occurs when the absolute error of either parameter with its previous value falls below a certain tolerance level. By default the tolerance is set to <strong>1e-6</strong>. If we wanted to increase the accuracy of our estimate, we can manually set a lower tolerance by adding the argument <code>tolerance = 1e-10</code>, for example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/NR_logit.html">NR_logit</a></span>(x, y, n, <span class="dt">tol =</span> <span class="fl">1e-15</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] "Initial Value: intercept = 0 slope = 0"
## [1] "Iteration 1 : intercept = 0.5127 , slope = -0.037627"
## [1] "Iteration 2 : intercept = 0.52291 , slope = -0.039209"
## [1] "Iteration 3 : intercept = 0.522919 , slope = -0.039211"
## [1] "Iteration 4 : intercept = 0.522919 , slope = -0.039211"
## [1] "Iteration 5 : intercept = 0.522919 , slope = -0.039211"
## [1] "MLE are intercept = 0.522919 and slope = -0.039211"</code></pre>
<pre><code>##   intercept       slope
## 1 0.5229187 -0.03921141</code></pre>
<p>Notice that the Newton-Raphson takes an additional iteration to converge because the tolerance has been set to a smaller value. In the context of this example, there is no significant difference from our previous estimate.</p>
</div>
<div id="em_blooda-b-ab-o-tol-1e-6-verbose-false" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#em_blooda-b-ab-o-tol-1e-6-verbose-false" class="anchor"> </a></body></html>EM_blood(A, B, AB, O, tol = 1e-6, verbose = FALSE)</h3>
<p>The second function of this package uses the EM algorithm to estimate the frequency of blood alleles (A, B, or O) in a population given their phenotypic frequencies. An iterative method is needed because closed form solutions cannot be obtained. The allele frequencies are intertwined within the six possible blood genotypes, forming the latent variables in our problem. More details are in the documentation via <code><a href="../reference/EM_blood.html">?EM_blood</a></code>.</p>
<p>Using <code>EM_blood</code>, you can quickly obtain the three MLE by providing the total number of people who have A, B, AB, and O blood types. The arguments <code>tol</code> and <code>verbose</code> are also implemented and function the exact same way as in <code>NR_logit</code>.</p>
<p>Let’s work through a simple example. Suppose the phenotypic frequencies are as given below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number of people who have each blood type in population</span>
A &lt;-<span class="st"> </span><span class="dv">80</span>; B &lt;-<span class="st"> </span><span class="dv">45</span>; AB &lt;-<span class="st"> </span><span class="dv">13</span>; O &lt;-<span class="st"> </span><span class="dv">100</span></code></pre></div>
<p>Then the allele frequencies are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/EM_blood.html">EM_blood</a></span>(A, B, AB, O)</code></pre></div>
<pre><code>##     pA_hat   pB_hat   pO_hat
## 1 0.219678 0.130473 0.649849</code></pre>
<p>The prevalence of the B antigen is the lowest in this population whereas having no antigen has the highest probability. <em>Note that the sum of the probabilities is always 1 (with some rounding error).</em></p>
<p>Again, we can inspect the iterative process using <code>verbose = TRUE</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/EM_blood.html">EM_blood</a></span>(A, B, AB, O, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## [1] "Initial Probs: pA = 0.333333 pB = 0.333333 pO =  0.333333"
## [1] "Iteration 1 : pA = 0.251401 pB = 0.153361 pO = 0.595238"
## [1] "Iteration 2 : pA = 0.224682 pB = 0.132638 pO = 0.642681"
## [1] "Iteration 3 : pA = 0.220385 pB = 0.130692 pO = 0.648923"
## [1] "Iteration 4 : pA = 0.219775 pB = 0.130498 pO = 0.649728"
## [1] "Iteration 5 : pA = 0.219691 pB = 0.130476 pO = 0.649833"
## [1] "Iteration 6 : pA = 0.21968 pB = 0.130474 pO = 0.649846"
## [1] "Iteration 7 : pA = 0.219678 pB = 0.130473 pO = 0.649848"
## [1] "Iteration 8 : pA = 0.219678 pB = 0.130473 pO = 0.649849"
## [1] "MLE are pA = 0.219678 pB = 0.130473 pO = 0.649849"</code></pre>
<pre><code>##     pA_hat   pB_hat   pO_hat
## 1 0.219678 0.130473 0.649849</code></pre>
<p>Note that the initial probabilities correspond to the situation of equally likely allele frequency.</p>
</div>
</div>
<div id="reflections" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#reflections" class="anchor"> </a></body></html>Reflections</h2>
<p><em>Note: this section would not normally appear in a vignette.</em></p>
<ol style="list-style-type: decimal">
<li><p>Trying to figure out how to get an <code>overview.md</code> to be produced from the vignette YAML. Ended up manually calling <code>rmarkdown::render("~/GitHub/naim/vignettes/overview.Rmd", "md_document")</code>. No conflicts with <code>R CMD Check</code> and <code>Build &amp; Reload</code>. Many thanks to the course instructor and TAs for help on this!</p></li>
<li><p>Sometimes my <code>Build &amp; Reload</code> doesn’t work unless I delete a <code>lock00</code> file in my home directory. Not sure why this is, but the package builds successfully thereafter.</p></li>
<li><p>Uncertainty about <code>LaTeX</code> style markup in R documentation. Seems like Greek letters like <code>\epsilon</code> work, but accents (<code>\hat</code>), operators (<code>\frac</code>), etc. do not. Wondering how to make the help files look as professional as possible.</p></li>
<li><p>My <code>R CMD Check</code> passed everything except for <strong>one NOTE</strong>: <code>* checking top-level files ... NOTE Non-standard file/directory found at top level: 'README.Rmd' 'README.html'</code>. To “fix” this I added <code>README.Rmd</code> and <code>README.html</code> to the <code>.Rbuildignore</code> file. Now the <code>R CMD Check</code> succeeds without any notes or warnings. My question is whether this workflow would coincide with CRAN guidelines after my modification to the <code>.Rbuildignore</code> file.</p></li>
<li><p>There seems to be a lot of repeated information in my documentation. I guess it’s best to be very clear about what your package does, but I found myself writing similar material in my <code>vignette</code>, <code>README</code>, <code><a href="../reference/naim.html">?naim</a></code> documentation, and <code>DESCRIPTION</code> file. It would be useful to have some more concrete guidance on any subtle differences, otherwise I would simply just copy over explanations, examples, etc.</p></li>
<li><p>Testing is very useful and forces me to look for loop holes in my function definition. May seem tedious at first but worth the effort if you want to write a professional package.</p></li>
<li><p>The two functions in this package were written by me very recently for another course called <em>STAT 560 Statistical Inference I</em>. I had the opportunity to streamline the functions, polish them up, and write explanations. No better way to learn the material than to incorporate them as functions in my own R package!</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#motivation">Motivation</a></li>
      <li><a href="#usage">Usage</a></li>
      <li><a href="#reflections">Reflections</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Derek Chiu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
